package com.example.shenghuobang.Setting;

import com.example.shenghuobang.R;

import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.preference.CheckBoxPreference;
import android.preference.EditTextPreference;
import android.preference.ListPreference;
import android.preference.Preference;
import android.preference.PreferenceActivity;
import android.preference.PreferenceManager;
import android.preference.PreferenceScreen;
import android.util.Log;
import android.widget.Toast;

public class SettingActivity extends PreferenceActivity implements
		Preference.OnPreferenceClickListener,
		Preference.OnPreferenceChangeListener {
	private static String TAG = "HelloPreference";          
	private CheckBoxPreference mapply_wifiPreference;       //打开wifi
	//private CheckBoxPreference mapply_internetPreference;   //Internet共享
	//private ListPreference depart_valuePreference;          //部门设置
	private EditTextPreference number_editPreference;       //输入电话号码
	private Preference version_update;             //wifi设置
	private String oldDeptId; // 旧部门的名称

	public void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		addPreferencesFromResource(R.xml.mypreference);
		
//		//根据key值找到控件
//		mapply_wifiPreference = (CheckBoxPreference) findPreference("apply_wifi");
//		//depart_valuePreference = (ListPreference) findPreference("depart_value");
		version_update = (Preference) findPreference("version_update");
//
//		// 设置监听器
//		//mapply_internetPreference.setOnPreferenceClickListener(this);
//		//mapply_internetPreference.setOnPreferenceChangeListener(this);
//		//depart_valuePreference.setOnPreferenceClickListener(this);
//		//depart_valuePreference.setOnPreferenceChangeListener(this);
//		number_editPreference.setOnPreferenceClickListener(this);
//		number_editPreference.setOnPreferenceChangeListener(this);
//		mwifi_settingPreference.setOnPreferenceClickListener(this);

		// 得到我们的存储Preferences值的对象，然后对其进行相应操作
//		SharedPreferences shp = PreferenceManager.getDefaultSharedPreferences(this);
//		boolean apply_wifiChecked = shp.getBoolean("apply_wifi", false);
	}

	
	// 点击事件触发
	@Override
	public boolean onPreferenceClick(Preference preference) {
		// TODO Auto-generated method stub
		Log.i(TAG, "onPreferenceClick----->"+String.valueOf(preference.getKey()));
		// 对控件进行操作
		
		return false;
	}
   //点击事件触发
	public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen,
			Preference preference) {
		Log.i(TAG, "onPreferenceTreeClick----->"+preference.getKey());
		
		if (preference.getKey().equals("version_update")) {

			Intent i = new Intent(SettingActivity.this, UpdateVersionActivity.class);  //MainActivity只是一个简单的Activity
			startActivity(i);
			return true;
		}
		return false;
	}

	// 当Preference的值发生改变时触发该事件，true则以新值更新控件的状态，false则do noting
	public boolean onPreferenceChange(Preference preference, Object objValue) {
		Log.i(TAG, "onPreferenceChange----->"+String.valueOf(preference.getKey()));
		if (preference == mapply_wifiPreference){
			Log.i(TAG, "Wifi CB, and isCheckd = " + String.valueOf(objValue));
		}else if (preference.getKey().equals("apply_internet")) {
			Log.i(TAG, "internet CB, and isCheckd = "+ String.valueOf(objValue));
			return false;  //不保存该新值
//		}else if (preference == depart_valuePreference){
//			Log.i(TAG, "  Old Value"+ depart_valuePreference.getValue()+" NewDeptName"+objValue);
		}else if (preference.getKey().equals("wifi_setting")) {
			Log.i(TAG, "change" + String.valueOf(objValue));
			version_update.setTitle("its turn me.");  //重新设置title
		} else if (preference == number_editPreference) {
			Log.i(TAG, "Old Value = " + String.valueOf(objValue));
			return false; // 不保存更新值
		}
		return true;  //保存更新后的值
	}
}
